# ServiceEntry para expor o serviço hello-app-engine do cluster remoto
# Este é um exemplo de como fazer comunicação multi-cluster SEM MCS
# Usando apenas ASM Multi-cluster (connected mode)

apiVersion: networking.istio.io/v1beta1
kind: ServiceEntry
metadata:
  name: hello-app-engine-remote
  namespace: mcs-demo
spec:
  hosts:
  # Usamos um hostname customizado (não clusterset.local, pois não temos MCS)
  - hello-app-engine-remote.mcs-demo.svc.cluster.local
  ports:
  - number: 80
    name: http
    protocol: HTTP
  resolution: STATIC
  # IMPORTANTE: Substitua <CLUSTER_IP> pelo ClusterIP real do serviço no cluster app-engine
  # Para obter: kubectl get svc hello-app-engine -n mcs-demo --context=<app-engine-context> -o jsonpath='{.spec.clusterIP}'
  addresses:
  - <CLUSTER_IP>  # Substituir pelo ClusterIP real
  location: MESH_INTERNAL
  # Endpoints estáticos - apontando para o ClusterIP do serviço remoto
  endpoints:
  - address: <CLUSTER_IP>  # Substituir pelo ClusterIP real
    ports:
      http: 80
